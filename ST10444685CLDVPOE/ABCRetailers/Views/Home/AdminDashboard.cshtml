@model ABCRetailers.Models.ViewModels.AdminDashboardViewModel
@{
    ViewData["Title"] = "Admin Dashboard";
}

<div class="container">
    <div class="row mb-4">
        <div class="col-12">
            <div class="alert alert-success">
                <h4><i class="fas fa-user-shield"></i> Welcome back, @User.Identity.Name!</h4>
                <p class="mb-0">You are logged in as: <strong>Admin</strong></p>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Customers Card -->
        <div class="col-md-4 mb-4">
            <div class="card text-white bg-primary h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h5 class="card-title">Manage Customers</h5>
                            <h2 class="display-4">@Model.CustomerCount</h2>
                            <p class="card-text">Total Customers</p>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-users fa-3x"></i>
                        </div>
                    </div>
                </div>
                <div class="card-footer">
                    <a href="/Customer" class="text-white">
                        <i class="fas fa-arrow-circle-right"></i> Manage Customers
                    </a>
                </div>
            </div>
        </div>

        <!-- Products Card -->
        <div class="col-md-4 mb-4">
            <div class="card text-white bg-success h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h5 class="card-title">Manage Products</h5>
                            <h2 class="display-4">@Model.ProductCount</h2>
                            <p class="card-text">Total Products</p>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-boxes fa-3x"></i>
                        </div>
                    </div>
                </div>
                <div class="card-footer">
                    <a href="/Product" class="text-white">
                        <i class="fas fa-arrow-circle-right"></i> Manage Products
                    </a>
                </div>
            </div>
        </div>

        <!-- Orders Card -->
        <div class="col-md-4 mb-4">
            <div class="card text-white bg-warning h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h5 class="card-title">Manage Orders</h5>
                            <h2 class="display-4">@Model.OrderCount</h2>
                            <p class="card-text">Total Orders</p>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-shopping-cart fa-3x"></i>
                        </div>
                    </div>
                </div>
                <div class="card-footer">
                    <a href="/Order" class="text-white">
                        <i class="fas fa-arrow-circle-right"></i> Manage Orders
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Additional Dashboard Sections -->
    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0"><i class="fas fa-upload"></i> Upload Files</h5>
                </div>
                <div class="card-body">
                    <p class="card-text">Payment proofs and document management</p>
                    <a href="/FileUpload" class="btn btn-outline-info">
                        <i class="fas fa-cloud-upload-alt"></i> Go to File Upload
                    </a>
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0"><i class="fas fa-star"></i> Featured Products</h5>
                </div>
                <div class="card-body">
                    <p class="card-text">Manage featured products and promotions</p>
                    <a href="/Product/Featured" class="btn btn-outline-secondary">
                        <i class="fas fa-cog"></i> Manage Featured
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Function to update dashboard counts
        function updateDashboardCounts() {
            fetch('/Home/GetDashboardCounts')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Update the count displays
                        const customerCountElement = document.querySelector('.bg-primary .display-4');
                        const productCountElement = document.querySelector('.bg-success .display-4');
                        const orderCountElement = document.querySelector('.bg-warning .display-4');

                        if (customerCountElement) customerCountElement.textContent = data.customerCount;
                        if (productCountElement) productCountElement.textContent = data.productCount;
                        if (orderCountElement) orderCountElement.textContent = data.orderCount;
                    }
                })
                .catch(error => console.error('Error updating counts:', error));
        }

        // Update counts every 30 seconds
        setInterval(updateDashboardCounts, 30000);
    </script>
}